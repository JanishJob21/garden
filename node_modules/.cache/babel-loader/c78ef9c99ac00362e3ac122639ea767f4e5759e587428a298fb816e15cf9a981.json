{"ast":null,"code":"var _jsxFileName = \"D:\\\\full stacks\\\\Garden\\\\garden-scheduler\\\\src\\\\context\\\\AuthContext.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { createContext, useContext, useEffect, useState } from 'react';\nimport { authLogin, authRegister, authMe, setToken, getToken } from '../services/api';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst AuthContext = /*#__PURE__*/createContext(null);\nexport function AuthProvider({\n  children\n}) {\n  _s();\n  const [user, setUser] = useState(() => {\n    const raw = localStorage.getItem('gs_user');\n    return raw ? JSON.parse(raw) : null;\n  });\n  useEffect(() => {\n    // Try to restore session from token\n    (async () => {\n      try {\n        if (!getToken()) return;\n        const {\n          user\n        } = await authMe();\n        if (user) {\n          const normalized = {\n            id: user._id || user.id,\n            name: user.name,\n            email: user.email,\n            role: (user.role || '').charAt(0).toUpperCase() + (user.role || '').slice(1)\n          };\n          localStorage.setItem('gs_user', JSON.stringify(normalized));\n          setUser(normalized);\n        }\n      } catch {\n        setToken(null);\n        localStorage.removeItem('gs_user');\n        setUser(null);\n      }\n    })();\n  }, []);\n  const login = async ({\n    email,\n    password\n  }) => {\n    const {\n      token,\n      user\n    } = await authLogin({\n      email,\n      password\n    });\n    setToken(token);\n    const normalized = {\n      id: user.id,\n      name: user.name,\n      email: user.email,\n      role: (user.role || '').charAt(0).toUpperCase() + (user.role || '').slice(1)\n    };\n    localStorage.setItem('gs_user', JSON.stringify(normalized));\n    setUser(normalized);\n  };\n  const signup = async ({\n    name,\n    email,\n    password,\n    role\n  }) => {\n    // role is expected in lowercase by backend\n    const {\n      token,\n      user\n    } = await authRegister({\n      name,\n      email,\n      password,\n      role: (role || '').toLowerCase()\n    });\n    setToken(token);\n    const normalized = {\n      id: user.id,\n      name: user.name,\n      email: user.email,\n      role: (user.role || '').charAt(0).toUpperCase() + (user.role || '').slice(1)\n    };\n    localStorage.setItem('gs_user', JSON.stringify(normalized));\n    setUser(normalized);\n  };\n  const logout = () => {\n    localStorage.removeItem('gs_user');\n    setToken(null);\n    setUser(null);\n  };\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: {\n      user,\n      login,\n      signup,\n      logout\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 55,\n    columnNumber: 5\n  }, this);\n}\n_s(AuthProvider, \"s5zOqZ3fIqF0lIz3Zh5wfUzhnXo=\");\n_c = AuthProvider;\nexport const useAuth = () => {\n  _s2();\n  return useContext(AuthContext);\n};\n_s2(useAuth, \"gDsCjeeItUuvgOWf1v4qoK9RF6k=\");\nvar _c;\n$RefreshReg$(_c, \"AuthProvider\");","map":{"version":3,"names":["React","createContext","useContext","useEffect","useState","authLogin","authRegister","authMe","setToken","getToken","jsxDEV","_jsxDEV","AuthContext","AuthProvider","children","_s","user","setUser","raw","localStorage","getItem","JSON","parse","normalized","id","_id","name","email","role","charAt","toUpperCase","slice","setItem","stringify","removeItem","login","password","token","signup","toLowerCase","logout","Provider","value","fileName","_jsxFileName","lineNumber","columnNumber","_c","useAuth","_s2","$RefreshReg$"],"sources":["D:/full stacks/Garden/garden-scheduler/src/context/AuthContext.js"],"sourcesContent":["import React, { createContext, useContext, useEffect, useState } from 'react';\nimport { authLogin, authRegister, authMe, setToken, getToken } from '../services/api';\n\nconst AuthContext = createContext(null)\n\nexport function AuthProvider({ children }) {\n  const [user, setUser] = useState(() => {\n    const raw = localStorage.getItem('gs_user')\n    return raw ? JSON.parse(raw) : null\n  })\n\n  useEffect(() => {\n    // Try to restore session from token\n    (async () => {\n      try {\n        if (!getToken()) return;\n        const { user } = await authMe();\n        if (user) {\n          const normalized = { id: user._id || user.id, name: user.name, email: user.email, role: (user.role || '').charAt(0).toUpperCase() + (user.role || '').slice(1) }\n          localStorage.setItem('gs_user', JSON.stringify(normalized))\n          setUser(normalized)\n        }\n      } catch {\n        setToken(null)\n        localStorage.removeItem('gs_user')\n        setUser(null)\n      }\n    })()\n  }, [])\n\n  const login = async ({ email, password }) => {\n    const { token, user } = await authLogin({ email, password })\n    setToken(token)\n    const normalized = { id: user.id, name: user.name, email: user.email, role: (user.role || '').charAt(0).toUpperCase() + (user.role || '').slice(1) }\n    localStorage.setItem('gs_user', JSON.stringify(normalized))\n    setUser(normalized)\n  }\n\n  const signup = async ({ name, email, password, role }) => {\n    // role is expected in lowercase by backend\n    const { token, user } = await authRegister({ name, email, password, role: (role || '').toLowerCase() })\n    setToken(token)\n    const normalized = { id: user.id, name: user.name, email: user.email, role: (user.role || '').charAt(0).toUpperCase() + (user.role || '').slice(1) }\n    localStorage.setItem('gs_user', JSON.stringify(normalized))\n    setUser(normalized)\n  }\n\n  const logout = () => {\n    localStorage.removeItem('gs_user')\n    setToken(null)\n    setUser(null)\n  }\n\n  return (\n    <AuthContext.Provider value={{ user, login, signup, logout }}>\n      {children}\n    </AuthContext.Provider>\n  )\n}\n\nexport const useAuth = () => useContext(AuthContext)\n"],"mappings":";;;AAAA,OAAOA,KAAK,IAAIC,aAAa,EAAEC,UAAU,EAAEC,SAAS,EAAEC,QAAQ,QAAQ,OAAO;AAC7E,SAASC,SAAS,EAAEC,YAAY,EAAEC,MAAM,EAAEC,QAAQ,EAAEC,QAAQ,QAAQ,iBAAiB;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAEtF,MAAMC,WAAW,gBAAGX,aAAa,CAAC,IAAI,CAAC;AAEvC,OAAO,SAASY,YAAYA,CAAC;EAAEC;AAAS,CAAC,EAAE;EAAAC,EAAA;EACzC,MAAM,CAACC,IAAI,EAAEC,OAAO,CAAC,GAAGb,QAAQ,CAAC,MAAM;IACrC,MAAMc,GAAG,GAAGC,YAAY,CAACC,OAAO,CAAC,SAAS,CAAC;IAC3C,OAAOF,GAAG,GAAGG,IAAI,CAACC,KAAK,CAACJ,GAAG,CAAC,GAAG,IAAI;EACrC,CAAC,CAAC;EAEFf,SAAS,CAAC,MAAM;IACd;IACA,CAAC,YAAY;MACX,IAAI;QACF,IAAI,CAACM,QAAQ,CAAC,CAAC,EAAE;QACjB,MAAM;UAAEO;QAAK,CAAC,GAAG,MAAMT,MAAM,CAAC,CAAC;QAC/B,IAAIS,IAAI,EAAE;UACR,MAAMO,UAAU,GAAG;YAAEC,EAAE,EAAER,IAAI,CAACS,GAAG,IAAIT,IAAI,CAACQ,EAAE;YAAEE,IAAI,EAAEV,IAAI,CAACU,IAAI;YAAEC,KAAK,EAAEX,IAAI,CAACW,KAAK;YAAEC,IAAI,EAAE,CAACZ,IAAI,CAACY,IAAI,IAAI,EAAE,EAAEC,MAAM,CAAC,CAAC,CAAC,CAACC,WAAW,CAAC,CAAC,GAAG,CAACd,IAAI,CAACY,IAAI,IAAI,EAAE,EAAEG,KAAK,CAAC,CAAC;UAAE,CAAC;UAChKZ,YAAY,CAACa,OAAO,CAAC,SAAS,EAAEX,IAAI,CAACY,SAAS,CAACV,UAAU,CAAC,CAAC;UAC3DN,OAAO,CAACM,UAAU,CAAC;QACrB;MACF,CAAC,CAAC,MAAM;QACNf,QAAQ,CAAC,IAAI,CAAC;QACdW,YAAY,CAACe,UAAU,CAAC,SAAS,CAAC;QAClCjB,OAAO,CAAC,IAAI,CAAC;MACf;IACF,CAAC,EAAE,CAAC;EACN,CAAC,EAAE,EAAE,CAAC;EAEN,MAAMkB,KAAK,GAAG,MAAAA,CAAO;IAAER,KAAK;IAAES;EAAS,CAAC,KAAK;IAC3C,MAAM;MAAEC,KAAK;MAAErB;IAAK,CAAC,GAAG,MAAMX,SAAS,CAAC;MAAEsB,KAAK;MAAES;IAAS,CAAC,CAAC;IAC5D5B,QAAQ,CAAC6B,KAAK,CAAC;IACf,MAAMd,UAAU,GAAG;MAAEC,EAAE,EAAER,IAAI,CAACQ,EAAE;MAAEE,IAAI,EAAEV,IAAI,CAACU,IAAI;MAAEC,KAAK,EAAEX,IAAI,CAACW,KAAK;MAAEC,IAAI,EAAE,CAACZ,IAAI,CAACY,IAAI,IAAI,EAAE,EAAEC,MAAM,CAAC,CAAC,CAAC,CAACC,WAAW,CAAC,CAAC,GAAG,CAACd,IAAI,CAACY,IAAI,IAAI,EAAE,EAAEG,KAAK,CAAC,CAAC;IAAE,CAAC;IACpJZ,YAAY,CAACa,OAAO,CAAC,SAAS,EAAEX,IAAI,CAACY,SAAS,CAACV,UAAU,CAAC,CAAC;IAC3DN,OAAO,CAACM,UAAU,CAAC;EACrB,CAAC;EAED,MAAMe,MAAM,GAAG,MAAAA,CAAO;IAAEZ,IAAI;IAAEC,KAAK;IAAES,QAAQ;IAAER;EAAK,CAAC,KAAK;IACxD;IACA,MAAM;MAAES,KAAK;MAAErB;IAAK,CAAC,GAAG,MAAMV,YAAY,CAAC;MAAEoB,IAAI;MAAEC,KAAK;MAAES,QAAQ;MAAER,IAAI,EAAE,CAACA,IAAI,IAAI,EAAE,EAAEW,WAAW,CAAC;IAAE,CAAC,CAAC;IACvG/B,QAAQ,CAAC6B,KAAK,CAAC;IACf,MAAMd,UAAU,GAAG;MAAEC,EAAE,EAAER,IAAI,CAACQ,EAAE;MAAEE,IAAI,EAAEV,IAAI,CAACU,IAAI;MAAEC,KAAK,EAAEX,IAAI,CAACW,KAAK;MAAEC,IAAI,EAAE,CAACZ,IAAI,CAACY,IAAI,IAAI,EAAE,EAAEC,MAAM,CAAC,CAAC,CAAC,CAACC,WAAW,CAAC,CAAC,GAAG,CAACd,IAAI,CAACY,IAAI,IAAI,EAAE,EAAEG,KAAK,CAAC,CAAC;IAAE,CAAC;IACpJZ,YAAY,CAACa,OAAO,CAAC,SAAS,EAAEX,IAAI,CAACY,SAAS,CAACV,UAAU,CAAC,CAAC;IAC3DN,OAAO,CAACM,UAAU,CAAC;EACrB,CAAC;EAED,MAAMiB,MAAM,GAAGA,CAAA,KAAM;IACnBrB,YAAY,CAACe,UAAU,CAAC,SAAS,CAAC;IAClC1B,QAAQ,CAAC,IAAI,CAAC;IACdS,OAAO,CAAC,IAAI,CAAC;EACf,CAAC;EAED,oBACEN,OAAA,CAACC,WAAW,CAAC6B,QAAQ;IAACC,KAAK,EAAE;MAAE1B,IAAI;MAAEmB,KAAK;MAAEG,MAAM;MAAEE;IAAO,CAAE;IAAA1B,QAAA,EAC1DA;EAAQ;IAAA6B,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACW,CAAC;AAE3B;AAAC/B,EAAA,CArDeF,YAAY;AAAAkC,EAAA,GAAZlC,YAAY;AAuD5B,OAAO,MAAMmC,OAAO,GAAGA,CAAA;EAAAC,GAAA;EAAA,OAAM/C,UAAU,CAACU,WAAW,CAAC;AAAA;AAAAqC,GAAA,CAAvCD,OAAO;AAAA,IAAAD,EAAA;AAAAG,YAAA,CAAAH,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}